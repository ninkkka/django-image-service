{% extends 'base.html' %}

{% block title %}Все изображения{% endblock %}

{% block content %}
<h2>Все изображения</h2>
<div id="imagesList"></div>

<script>
async function loadImages() {
    try {
        const response = await fetch('/api/images/list/');
        const images = await response.json();
        
        const container = document.getElementById('imagesList');
        
        if (images.length === 0) {
            container.innerHTML = '<p>Нет загруженных изображений</p>';
            return;
        }
        
        let html = '<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px;">';
        
        images.forEach(image => {
            html += `
                <div style="border: 1px solid #ddd; padding: 10px; border-radius: 5px;">
                    <h3>${image.title}</h3>
                    <img src="${image.image_url}" alt="${image.title}" 
                         style="width: 100%; height: 200px; object-fit: cover; border-radius: 3px;">
                    <p>Формат: ${image.format}</p>
                    <p>Размер: ${image.file_size_mb} MB</p>
                    <p>Дата: ${new Date(image.uploaded_at).toLocaleDateString()}</p>
                    <a href="/image/${image.id}" style="display: inline-block; margin-top: 10px; padding: 5px 10px; background-color: #007bff; color: white; text-decoration: none; border-radius: 3px;">
                        Подробнее
                    </a>
                </div>
            `;
        });
        
        html += '</div>';
        container.innerHTML = html;
    } catch (error) {
        document.getElementById('imagesList').innerHTML = `
            <div style="color: red;">
                Ошибка при загрузке изображений: ${error.message}
            </div>
        `;
    }
}

document.addEventListener('DOMContentLoaded', loadImages);
</script>
{% endblock %}
